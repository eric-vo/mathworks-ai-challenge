cleanOriginalDir = "data/test/gabrielSamples/clean8Khz";
noiseDir = "data/noise";
noisyOutputDir = "data/test/gabrielSamples/noisy8Khz";
denoisedOutputDir = "data/test/gabrielSamples/output_wav";
%%
generateNoisyDir(cleanOriginalDir, noiseDir, noisyOutputDir, 5) %[output:189d1a20]
%%
denoisedAudioArray = denoiseSpeechDir(noisyOutputDir, denoisedOutputDir);
%%
[correlations, avgCorr] = calculateCorrelationDir(denoisedAudioArray, cleanOriginalDir, 5, 10); %[output:9ae159a8]

disp("Correlations:") %[output:12e6ab6e]
disp(correlations) %[output:3380d940]
fprintf('Average correlation: %.6f\n', avgCorr); %[output:5b3b9c65]

%[appendix]{"version":"1.0"}
%---
%[metadata:view]
%   data: {"layout":"inline","rightPanelPercent":30.4}
%---
%[output:189d1a20]
%   data: {"dataType":"text","outputData":{"text":"Mixing 1.wav + birds_farm.wav at 5 dB SNR...\nMixing 1.wav + cafe.wav at 5 dB SNR...\nMixing 1.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 1.wav + pencils.wav at 5 dB SNR...\nMixing 1.wav + waves.wav at 5 dB SNR...\nMixing 10.wav + birds_farm.wav at 5 dB SNR...\nMixing 10.wav + cafe.wav at 5 dB SNR...\nMixing 10.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 10.wav + pencils.wav at 5 dB SNR...\nMixing 10.wav + waves.wav at 5 dB SNR...\nMixing 2.wav + birds_farm.wav at 5 dB SNR...\nMixing 2.wav + cafe.wav at 5 dB SNR...\nMixing 2.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 2.wav + pencils.wav at 5 dB SNR...\nMixing 2.wav + waves.wav at 5 dB SNR...\nMixing 3.wav + birds_farm.wav at 5 dB SNR...\nMixing 3.wav + cafe.wav at 5 dB SNR...\nMixing 3.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 3.wav + pencils.wav at 5 dB SNR...\nMixing 3.wav + waves.wav at 5 dB SNR...\nMixing 4.wav + birds_farm.wav at 5 dB SNR...\nMixing 4.wav + cafe.wav at 5 dB SNR...\nMixing 4.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 4.wav + pencils.wav at 5 dB SNR...\nMixing 4.wav + waves.wav at 5 dB SNR...\nMixing 5.wav + birds_farm.wav at 5 dB SNR...\nMixing 5.wav + cafe.wav at 5 dB SNR...\nMixing 5.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 5.wav + pencils.wav at 5 dB SNR...\nMixing 5.wav + waves.wav at 5 dB SNR...\nMixing 6.wav + birds_farm.wav at 5 dB SNR...\nMixing 6.wav + cafe.wav at 5 dB SNR...\nMixing 6.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 6.wav + pencils.wav at 5 dB SNR...\nMixing 6.wav + waves.wav at 5 dB SNR...\nMixing 7.wav + birds_farm.wav at 5 dB SNR...\nMixing 7.wav + cafe.wav at 5 dB SNR...\nMixing 7.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 7.wav + pencils.wav at 5 dB SNR...\nMixing 7.wav + waves.wav at 5 dB SNR...\nMixing 8.wav + birds_farm.wav at 5 dB SNR...\nMixing 8.wav + cafe.wav at 5 dB SNR...\nMixing 8.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 8.wav + pencils.wav at 5 dB SNR...\nMixing 8.wav + waves.wav at 5 dB SNR...\nMixing 9.wav + birds_farm.wav at 5 dB SNR...\nMixing 9.wav + cafe.wav at 5 dB SNR...\nMixing 9.wav + jet_city_birds.wav at 5 dB SNR...\nMixing 9.wav + pencils.wav at 5 dB SNR...\nMixing 9.wav + waves.wav at 5 dB SNR...\nAll files processed and saved.\n","truncated":false}}
%---
%[output:9ae159a8]
%   data: {"dataType":"text","outputData":{"text":"Processing clean file 1.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.027209\nMSE: 0.000740\nSNR: 8.39 dB\nNRMSE: 0.380650\nPSNR: 22.42 dB\nMAE: 0.017735\nCorrelation: 0.927021\n\nProcessing clean file 1.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.024283\nMSE: 0.000590\nSNR: 9.38 dB\nNRMSE: 0.339713\nPSNR: 23.41 dB\nMAE: 0.018008\nCorrelation: 0.941049\n\nProcessing clean file 1.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.019062\nMSE: 0.000363\nSNR: 11.48 dB\nNRMSE: 0.266670\nPSNR: 25.51 dB\nMAE: 0.013880\nCorrelation: 0.964063\n\nProcessing clean file 1.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.023712\nMSE: 0.000562\nSNR: 9.58 dB\nNRMSE: 0.331718\nPSNR: 23.62 dB\nMAE: 0.012896\nCorrelation: 0.944836\n\nProcessing clean file 1.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.018564\nMSE: 0.000345\nSNR: 11.71 dB\nNRMSE: 0.259706\nPSNR: 25.74 dB\nMAE: 0.013249\nCorrelation: 0.967135\n\nProcessing clean file 2.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.020527\nMSE: 0.000421\nSNR: 7.45 dB\nNRMSE: 0.423989\nPSNR: 22.14 dB\nMAE: 0.013490\nCorrelation: 0.906746\n\nProcessing clean file 2.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.017867\nMSE: 0.000319\nSNR: 8.66 dB\nNRMSE: 0.369047\nPSNR: 23.35 dB\nMAE: 0.013443\nCorrelation: 0.929844\n\nProcessing clean file 2.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.014589\nMSE: 0.000213\nSNR: 10.42 dB\nNRMSE: 0.301337\nPSNR: 25.11 dB\nMAE: 0.010662\nCorrelation: 0.953522\n\nProcessing clean file 2.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.017578\nMSE: 0.000309\nSNR: 8.80 dB\nNRMSE: 0.363072\nPSNR: 23.49 dB\nMAE: 0.010057\nCorrelation: 0.932875\n\nProcessing clean file 2.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.013189\nMSE: 0.000174\nSNR: 11.30 dB\nNRMSE: 0.272423\nPSNR: 25.99 dB\nMAE: 0.009778\nCorrelation: 0.963369\n\nProcessing clean file 3.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.021658\nMSE: 0.000469\nSNR: 7.71 dB\nNRMSE: 0.411517\nPSNR: 21.46 dB\nMAE: 0.014790\nCorrelation: 0.912272\n\nProcessing clean file 3.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.019361\nMSE: 0.000375\nSNR: 8.69 dB\nNRMSE: 0.367869\nPSNR: 22.43 dB\nMAE: 0.014642\nCorrelation: 0.930067\n\nProcessing clean file 3.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.015344\nMSE: 0.000235\nSNR: 10.71 dB\nNRMSE: 0.291534\nPSNR: 24.45 dB\nMAE: 0.011655\nCorrelation: 0.956923\n\nProcessing clean file 3.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.019269\nMSE: 0.000371\nSNR: 8.73 dB\nNRMSE: 0.366116\nPSNR: 22.48 dB\nMAE: 0.011016\nCorrelation: 0.931704\n\nProcessing clean file 3.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.015619\nMSE: 0.000244\nSNR: 10.55 dB\nNRMSE: 0.296775\nPSNR: 24.30 dB\nMAE: 0.011804\nCorrelation: 0.956946\n\nProcessing clean file 4.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.040227\nMSE: 0.001618\nSNR: 8.71 dB\nNRMSE: 0.366754\nPSNR: 24.36 dB\nMAE: 0.026121\nCorrelation: 0.930789\n\nProcessing clean file 4.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.041096\nMSE: 0.001689\nSNR: 8.53 dB\nNRMSE: 0.374684\nPSNR: 24.17 dB\nMAE: 0.030570\nCorrelation: 0.928032\n\nProcessing clean file 4.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.031077\nMSE: 0.000966\nSNR: 10.95 dB\nNRMSE: 0.283339\nPSNR: 26.60 dB\nMAE: 0.022168\nCorrelation: 0.959373\n\nProcessing clean file 4.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.045955\nMSE: 0.002112\nSNR: 7.56 dB\nNRMSE: 0.418978\nPSNR: 23.20 dB\nMAE: 0.030105\nCorrelation: 0.937661\n\nProcessing clean file 4.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.027024\nMSE: 0.000730\nSNR: 12.17 dB\nNRMSE: 0.246383\nPSNR: 27.81 dB\nMAE: 0.019411\nCorrelation: 0.971243\n\nProcessing clean file 5.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.025436\nMSE: 0.000647\nSNR: 9.40 dB\nNRMSE: 0.338663\nPSNR: 22.64 dB\nMAE: 0.017242\nCorrelation: 0.941266\n\nProcessing clean file 5.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.027512\nMSE: 0.000757\nSNR: 8.72 dB\nNRMSE: 0.366301\nPSNR: 21.96 dB\nMAE: 0.020610\nCorrelation: 0.930800\n\nProcessing clean file 5.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.020616\nMSE: 0.000425\nSNR: 11.23 dB\nNRMSE: 0.274487\nPSNR: 24.46 dB\nMAE: 0.015044\nCorrelation: 0.961639\n\nProcessing clean file 5.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.026414\nMSE: 0.000698\nSNR: 9.08 dB\nNRMSE: 0.351682\nPSNR: 22.31 dB\nMAE: 0.014468\nCorrelation: 0.937331\n\nProcessing clean file 5.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.020527\nMSE: 0.000421\nSNR: 11.27 dB\nNRMSE: 0.273298\nPSNR: 24.50 dB\nMAE: 0.015362\nCorrelation: 0.963329\n\nProcessing clean file 6.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.028596\nMSE: 0.000818\nSNR: 8.07 dB\nNRMSE: 0.394719\nPSNR: 22.02 dB\nMAE: 0.019062\nCorrelation: 0.920309\n\nProcessing clean file 6.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.026468\nMSE: 0.000701\nSNR: 8.75 dB\nNRMSE: 0.365351\nPSNR: 22.69 dB\nMAE: 0.019863\nCorrelation: 0.931753\n\nProcessing clean file 6.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.020528\nMSE: 0.000421\nSNR: 10.95 dB\nNRMSE: 0.283357\nPSNR: 24.90 dB\nMAE: 0.015320\nCorrelation: 0.959186\n\nProcessing clean file 6.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.024806\nMSE: 0.000615\nSNR: 9.31 dB\nNRMSE: 0.342397\nPSNR: 23.26 dB\nMAE: 0.013755\nCorrelation: 0.940511\n\nProcessing clean file 6.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.019625\nMSE: 0.000385\nSNR: 11.34 dB\nNRMSE: 0.270893\nPSNR: 25.29 dB\nMAE: 0.014478\nCorrelation: 0.964430\n\nProcessing clean file 7.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.040251\nMSE: 0.001620\nSNR: 8.35 dB\nNRMSE: 0.382474\nPSNR: 23.35 dB\nMAE: 0.025375\nCorrelation: 0.924725\n\nProcessing clean file 7.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.038147\nMSE: 0.001455\nSNR: 8.81 dB\nNRMSE: 0.362474\nPSNR: 23.81 dB\nMAE: 0.028113\nCorrelation: 0.932417\n\nProcessing clean file 7.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.030363\nMSE: 0.000922\nSNR: 10.80 dB\nNRMSE: 0.288512\nPSNR: 25.80 dB\nMAE: 0.021930\nCorrelation: 0.957628\n\nProcessing clean file 7.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.042020\nMSE: 0.001766\nSNR: 7.97 dB\nNRMSE: 0.399278\nPSNR: 22.97 dB\nMAE: 0.026841\nCorrelation: 0.938846\n\nProcessing clean file 7.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.026924\nMSE: 0.000725\nSNR: 11.84 dB\nNRMSE: 0.255836\nPSNR: 26.84 dB\nMAE: 0.018768\nCorrelation: 0.968895\n\nProcessing clean file 8.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.025823\nMSE: 0.000667\nSNR: 9.83 dB\nNRMSE: 0.322293\nPSNR: 23.42 dB\nMAE: 0.017842\nCorrelation: 0.947090\n\nProcessing clean file 8.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.029694\nMSE: 0.000882\nSNR: 8.62 dB\nNRMSE: 0.370604\nPSNR: 22.21 dB\nMAE: 0.022545\nCorrelation: 0.929925\n\nProcessing clean file 8.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.021439\nMSE: 0.000460\nSNR: 11.45 dB\nNRMSE: 0.267580\nPSNR: 25.04 dB\nMAE: 0.016018\nCorrelation: 0.963599\n\nProcessing clean file 8.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.028162\nMSE: 0.000793\nSNR: 9.08 dB\nNRMSE: 0.351481\nPSNR: 22.67 dB\nMAE: 0.016455\nCorrelation: 0.936241\n\nProcessing clean file 8.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.021123\nMSE: 0.000446\nSNR: 11.58 dB\nNRMSE: 0.263624\nPSNR: 25.17 dB\nMAE: 0.016078\nCorrelation: 0.965917\n\nProcessing clean file 9.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.030179\nMSE: 0.000911\nSNR: 8.10 dB\nNRMSE: 0.393517\nPSNR: 21.85 dB\nMAE: 0.020289\nCorrelation: 0.920046\n\nProcessing clean file 9.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.028461\nMSE: 0.000810\nSNR: 8.61 dB\nNRMSE: 0.371114\nPSNR: 22.36 dB\nMAE: 0.021358\nCorrelation: 0.928649\n\nProcessing clean file 9.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.022710\nMSE: 0.000516\nSNR: 10.57 dB\nNRMSE: 0.296117\nPSNR: 24.32 dB\nMAE: 0.016971\nCorrelation: 0.955966\n\nProcessing clean file 9.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.026965\nMSE: 0.000727\nSNR: 9.08 dB\nNRMSE: 0.351600\nPSNR: 22.83 dB\nMAE: 0.015743\nCorrelation: 0.936512\n\nProcessing clean file 9.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.021697\nMSE: 0.000471\nSNR: 10.97 dB\nNRMSE: 0.282912\nPSNR: 24.72 dB\nMAE: 0.016260\nCorrelation: 0.963067\n\nProcessing clean file 10.wav, denoised version 1\n=== Audio Error Metrics ===\nRMSE: 0.050074\nMSE: 0.002507\nSNR: 7.93 dB\nNRMSE: 0.401220\nPSNR: 21.51 dB\nMAE: 0.033080\nCorrelation: 0.917227\n\nProcessing clean file 10.wav, denoised version 2\n=== Audio Error Metrics ===\nRMSE: 0.047943\nMSE: 0.002299\nSNR: 8.31 dB\nNRMSE: 0.384142\nPSNR: 21.89 dB\nMAE: 0.036153\nCorrelation: 0.923957\n\nProcessing clean file 10.wav, denoised version 3\n=== Audio Error Metrics ===\nRMSE: 0.035612\nMSE: 0.001268\nSNR: 10.89 dB\nNRMSE: 0.285337\nPSNR: 24.47 dB\nMAE: 0.026265\nCorrelation: 0.958645\n\nProcessing clean file 10.wav, denoised version 4\n=== Audio Error Metrics ===\nRMSE: 0.058873\nMSE: 0.003466\nSNR: 6.53 dB\nNRMSE: 0.471715\nPSNR: 20.11 dB\nMAE: 0.040960\nCorrelation: 0.939683\n\nProcessing clean file 10.wav, denoised version 5\n=== Audio Error Metrics ===\nRMSE: 0.032534\nMSE: 0.001058\nSNR: 11.68 dB\nNRMSE: 0.260678\nPSNR: 25.26 dB\nMAE: 0.023664\nCorrelation: 0.968770\n\nCorrelation values for clean file 1: 0.9270 0.9410 0.9641 0.9448 0.9671 \nCorrelation values for clean file 2: 0.9067 0.9298 0.9535 0.9329 0.9634 \nCorrelation values for clean file 3: 0.9123 0.9301 0.9569 0.9317 0.9569 \nCorrelation values for clean file 4: 0.9308 0.9280 0.9594 0.9377 0.9712 \nCorrelation values for clean file 5: 0.9413 0.9308 0.9616 0.9373 0.9633 \nCorrelation values for clean file 6: 0.9203 0.9318 0.9592 0.9405 0.9644 \nCorrelation values for clean file 7: 0.9247 0.9324 0.9576 0.9388 0.9689 \nCorrelation values for clean file 8: 0.9471 0.9299 0.9636 0.9362 0.9659 \nCorrelation values for clean file 9: 0.9200 0.9286 0.9560 0.9365 0.9631 \nCorrelation values for clean file 10: 0.9172 0.9240 0.9586 0.9397 0.9688 \nAverage correlation across all files: 0.9435\n","truncated":false}}
%---
%[output:12e6ab6e]
%   data: {"dataType":"text","outputData":{"text":"Correlations:\n","truncated":false}}
%---
%[output:3380d940]
%   data: {"dataType":"text","outputData":{"text":"    0.9270    0.9410    0.9641    0.9448    0.9671\n    0.9067    0.9298    0.9535    0.9329    0.9634\n    0.9123    0.9301    0.9569    0.9317    0.9569\n    0.9308    0.9280    0.9594    0.9377    0.9712\n    0.9413    0.9308    0.9616    0.9373    0.9633\n    0.9203    0.9318    0.9592    0.9405    0.9644\n    0.9247    0.9324    0.9576    0.9388    0.9689\n    0.9471    0.9299    0.9636    0.9362    0.9659\n    0.9200    0.9286    0.9560    0.9365    0.9631\n    0.9172    0.9240    0.9586    0.9397    0.9688\n\n","truncated":false}}
%---
%[output:5b3b9c65]
%   data: {"dataType":"text","outputData":{"text":"Average correlation: 0.943477\n","truncated":false}}
%---
